{% extends 'base.html' %}
{% load socialaccount %}

{% block title %}Регистрация - {{ FORUM_CONFIG.name }}{% endblock %}

{% block content %}
<div class="card" style="max-width: 500px; margin: 2rem auto;">
    <h1 style="text-align: center; margin-bottom: 1.5rem;">Регистрация</h1>
    
    {% if form.errors %}
        <div style="background: #fee2e2; border-left: 4px solid #dc2626; padding: 1rem; margin-bottom: 1.5rem; border-radius: 6px;">
            <p style="color: #991b1b; margin: 0;">Пожалуйста, исправьте ошибки ниже.</p>
        </div>
    {% endif %}
    
    <form method="post" action="{% url 'account_signup' %}">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="id_username">Логин</label>
            <input type="text" name="username" id="id_username" maxlength="150" required autofocus
                   value="{{ form.username.value|default:'' }}"
                   style="width: 100%; padding: 0.7rem; border: 1px solid var(--border); border-radius: 6px; background: var(--bg-main); color: var(--text-primary); font-size: 1rem; font-family: inherit;">
            {% if form.username.errors %}
                <span style="color: #dc2626; font-size: 0.85rem;">{{ form.username.errors.0 }}</span>
            {% endif %}
        </div>
        
        <div class="form-group">
            <label for="id_email">Email</label>
            <input type="email" name="email" id="id_email" required 
                   value="{{ form.email.value|default:'' }}"
                   style="width: 100%; padding: 0.7rem; border: 1px solid var(--border); border-radius: 6px; background: var(--bg-main); color: var(--text-primary); font-size: 1rem; font-family: inherit;">
            {% if form.email.errors %}
                <span style="color: #dc2626; font-size: 0.85rem;">{{ form.email.errors.0 }}</span>
            {% endif %}
        </div>
        
        <div class="form-group">
            <label for="id_password1">Пароль</label>
            <input type="password" name="password1" id="id_password1" required 
                   style="width: 100%; padding: 0.7rem; border: 1px solid var(--border); border-radius: 6px; background: var(--bg-main); color: var(--text-primary); font-size: 1rem; font-family: inherit;">
            {% if form.password1.errors %}
                <span style="color: #dc2626; font-size: 0.85rem;">{{ form.password1.errors.0 }}</span>
            {% endif %}
        </div>
        
        <div class="form-group">
            <label for="id_password2">Подтвердите пароль</label>
            <input type="password" name="password2" id="id_password2" required 
                   style="width: 100%; padding: 0.7rem; border: 1px solid var(--border); border-radius: 6px; background: var(--bg-main); color: var(--text-primary); font-size: 1rem; font-family: inherit;">
            {% if form.password2.errors %}
                <span style="color: #dc2626; font-size: 0.85rem;">{{ form.password2.errors.0 }}</span>
            {% endif %}
        </div>
        
        {% if form.non_field_errors %}
            <div style="color: #dc2626; margin-bottom: 1rem;">
                {{ form.non_field_errors }}
            </div>
        {% endif %}
        
        <button type="submit" class="btn" style="width: 100%; padding: 0.7rem; font-size: 1rem; font-weight: 500;">Зарегистрироваться</button>
        
        {% if redirect_field_value %}
            <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
        {% endif %}
    </form>
    
    <!-- Divider -->
    <div style="display: flex; align-items: center; margin: 1.5rem 0;">
        <div style="flex: 1; height: 1px; background: var(--border);"></div>
        <span style="padding: 0 1rem; color: var(--text-secondary); font-size: 0.9rem;">или</span>
        <div style="flex: 1; height: 1px; background: var(--border);"></div>
    </div>
    
    <!-- Google Login Button -->
    <a href="{% provider_login_url 'google' %}" class="btn" style="width: 100%; padding: 0.7rem; font-size: 1rem; font-weight: 500; display: flex; align-items: center; justify-content: center; gap: 0.5rem; background: #fff; color: #444; border: 1px solid var(--border); text-decoration: none;">
        <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
            <path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.875 2.684-6.615z" fill="#4285F4"/>
            <path d="M9.003 18c2.43 0 4.467-.806 5.956-2.18L12.05 13.56c-.806.54-1.836.86-3.047.86-2.344 0-4.328-1.584-5.036-3.711H.96v2.332C2.44 15.983 5.485 18 9.003 18z" fill="#34A853"/>
            <path d="M3.964 10.712c-.18-.54-.282-1.117-.282-1.71 0-.593.102-1.17.282-1.71V4.96H.957C.347 6.175 0 7.55 0 9.002c0 1.452.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/>
            <path d="M9.003 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.464.891 11.426 0 9.003 0 5.485 0 2.44 2.017.96 4.958L3.967 7.29c.708-2.127 2.692-3.71 5.036-3.71z" fill="#EA4335"/>
        </svg>
        Зарегистрироваться через Google
    </a>
    
    <p style="text-align: center; margin-top: 1rem; color: var(--text-secondary);">
        Уже есть аккаунт? <a href="{% url 'account_login' %}" style="color: var(--primary);">Войти</a>
    </p>
</div>
{% endblock %}
