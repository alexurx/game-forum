{% extends 'base.html' %}

{% block title %}{{ profile_user.username }} - {{ FORUM_CONFIG.name }}{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; gap: 2rem; align-items: start;">
        <div style="text-align: center;">
            {% if profile_user.avatar %}
            <img src="{{ profile_user.avatar.url }}" alt="{{ profile_user.username }}" 
                 style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover;">
            {% else %}
            <div style="width: 120px; height: 120px; border-radius: 50%; background: var(--primary); color: white; 
                        display: flex; align-items: center; justify-content: center; font-size: 3rem; margin: 0 auto;">
                {{ profile_user.username|first|upper }}
            </div>
            {% endif %}
        </div>
        
        <div style="flex: 1;">
            <h1>{{ profile_user.username }}</h1>
            <div style="display: flex; gap: 1rem; margin: 1rem 0; color: var(--text-secondary); flex-wrap: wrap;">
                {% if profile_user.role == 'admin' %}
                <span style="background: linear-gradient(135deg, #ff4655 0%, #ff8800 100%); color: white; padding: 0.4rem 0.8rem; border-radius: 6px; font-weight: 500;">
                    üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
                </span>
                {% elif profile_user.role == 'moderator' %}
                <span style="background: #6366f1; color: white; padding: 0.4rem 0.8rem; border-radius: 6px; font-weight: 500;">
                    üõ°Ô∏è –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä
                </span>
                {% else %}
                <span style="background: var(--bg-tertiary); padding: 0.4rem 0.8rem; border-radius: 6px;">
                    üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                </span>
                {% endif %}
                <span>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: {{ profile_user.created_at|date:"d.m.Y" }}</span>
            </div>
            
            {% if profile_user.bio %}
            <p style="margin-top: 1rem; color: var(--text-secondary);">{{ profile_user.bio }}</p>
            {% endif %}
            
            <div style="display: flex; gap: 2rem; margin-top: 1.5rem; font-size: 0.95rem;">
                <div>
                    <strong>{{ profile_user.get_topic_count }}</strong>
                    <span style="color: var(--text-secondary);">—Ç–µ–º</span>
                </div>
                <div>
                    <strong>{{ profile_user.get_post_count }}</strong>
                    <span style="color: var(--text-secondary);">—Å–æ–æ–±—â–µ–Ω–∏–π</span>
                </div>
                <div>
                    <strong>{{ achievements.count }}</strong>
                    <span style="color: var(--text-secondary);">–∞—á–∏–≤–æ–∫</span>
                </div>
            </div>
            
            {% if user == profile_user %}
            <a href="{% url 'users:edit_profile' %}" class="btn" style="margin-top: 1rem;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
            {% endif %}
        </div>
    </div>
</div>

{% if achievements %}
<div class="card">
    <h2>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
        {% for user_achievement in achievements %}
        <div style="background: var(--bg-tertiary); padding: 1rem; border-radius: 6px;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">{{ user_achievement.achievement.icon }}</div>
            <strong>{{ user_achievement.achievement.name }}</strong>
            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">
                {{ user_achievement.achievement.description }}
            </p>
            <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                –ü–æ–ª—É—á–µ–Ω–æ: {{ user_achievement.earned_at|date:"d.m.Y" }}
            </p>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if recent_topics %}
<div class="card">
    <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç–µ–º—ã</h2>
    {% for topic in recent_topics %}
    <div style="padding: 0.75rem 0; {% if not forloop.last %}border-bottom: 1px solid var(--border);{% endif %}">
        <a href="{% url 'forum:topic_detail' topic.pk %}" style="color: var(--text-primary); text-decoration: none; font-weight: 500;">
            {{ topic.title }}
        </a>
        <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">
            –≤ <a href="{% url 'forum:category_detail' topic.category.pk %}" style="color: var(--primary); text-decoration: none;">{{ topic.category.name }}</a>
            ‚Ä¢ {{ topic.created_at|date:"d.m.Y H:i" }}
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
{% endblock %}